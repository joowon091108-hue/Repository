<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>개 짱짱 쩌는 TRPG용 주사위</title>
    <style>
        body { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; background-color: #f8f9fa; font-family: 'Apple SD Gothic Neo', sans-serif; margin: 0; }
        
        /* 닉네임 입력 창 */
        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #login-screen input { padding: 10px; font-size: 1.2rem; margin-bottom: 10px; border: 2px solid #007bff; border-radius: 8px; }
        
        h2 { color: #333; margin-top: 0; min-height: 1.5em; text-align: center; }
        #dice-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin: 20px; min-height: 100px; max-width: 500px; }
        .dice { width: 70px; height: 70px; background: white; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: 2px solid #eee; }
        .controls { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); text-align: center; width: 300px; }
        
        /* 로그 창 스타일 */
        #log-container { margin-top: 20px; width: 300px; height: 120px; background: #eee; border-radius: 10px; padding: 10px; overflow-y: auto; font-size: 0.9rem; border: 1px solid #ddd; }
        .log-entry { margin-bottom: 5px; color: #555; border-bottom: 1px solid #e0e0e0; padding-bottom: 2px; }

        button { padding: 12px 20px; font-size: 1rem; cursor: pointer; border: none; border-radius: 8px; transition: 0.2s; font-weight: bold; }
        .btn-adj { background-color: #e9ecef; color: #495057; width: 50px; }
        .btn-roll { background-color: #007bff; color: white; width: 100%; margin-top: 15px; }
        .btn-roll:disabled { background-color: #ccc; }
        
        .rolling { animation: shake 0.4s ease-in-out; }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            20% { transform: translate(-1px, -2px) rotate(-5deg); }
            40% { transform: translate(-3px, 0px) rotate(5deg); }
            60% { transform: translate(3px, 2px) rotate(-5deg); }
            80% { transform: translate(1px, -1px) rotate(5deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }
    </style>
</head>
<body>

    <div id="login-screen">
        <h2>사용할 닉네임을 입력하세요</h2>
        <input type="text" id="user-name" placeholder="닉네임..." onkeypress="if(event.keyCode==13) startGame()">
        <button onclick="startGame()" style="background: #007bff; color: white;">시작하기</button>
    </div>

    <h2 id="result-text">나와라 주사위!</h2>

    <div id="dice-container"></div>

    <div class="controls">
        <div class="count-display">주사위: <span id="dice-count" style="color: #007bff; font-weight: bold;">1</span>개</div>
        <button class="btn-adj" onclick="changeCount(-1)">-</button>
        <button class="btn-adj" onclick="changeCount(1)">+</button>
        <br>
        <button id="roll-button" class="btn-roll" onclick="rollAll()">굴리기</button>
    </div>

    <div id="log-container">
        <div class="log-entry">어서오세요! 닉네임을 정하고 굴려보세요.</div>
    </div>

    <script>
        let count = 1;
        let nickname = "무명";
        const container = document.getElementById('dice-container');
        const countDisplay = document.getElementById('dice-count');
        const rollButton = document.getElementById('roll-button');
        const resultText = document.getElementById('result-text');
        const logContainer = document.getElementById('log-container');

        // 게임 시작 (닉네임 설정)
        function startGame() {
            const nameInput = document.getElementById('user-name').value;
            if(nameInput.trim() === "") {
                alert("닉네임을 입력해줘!");
                return;
            }
            nickname = nameInput;
            document.getElementById('login-screen').style.display = 'none';
            addLog(`[시스템] ${nickname}님이 입장하셨습니다.`);
            updateDice();
        }

        function changeCount(n) {
            count += n;
            if (count < 1) count = 1;
            if (count > 12) count = 12;
            countDisplay.innerText = count;
            updateDice();
        }

        function updateDice() {
            container.innerHTML = '';
            for (let i = 0; i < count; i++) {
                const dice = document.createElement('div');
                dice.className = 'dice';
                dice.innerText = '?';
                container.appendChild(dice);
            }
        }

        // 로그 추가 함수
        function addLog(message) {
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerText = message;
            logContainer.prepend(entry); // 최신 로그가 위로 오게 함
        }

        function rollAll() {
            const diceElements = document.querySelectorAll('.dice');
            rollButton.disabled = true;
            let total = 0;
            let completed = 0;

            // 굴리기 시작 로그
            addLog(`${nickname}님이 주사위를 굴립니다...`);

            diceElements.forEach((dice) => {
                dice.classList.remove('rolling');
                void dice.offsetWidth; 
                dice.classList.add('rolling');
                
                setTimeout(() => {
                    const result = Math.floor(Math.random() * 6) + 1;
                    dice.innerText = result;
                    total += result;
                    completed++;
                    
                    if (completed === diceElements.length) {
                        rollButton.disabled = false;
                        resultText.innerText = "합계: " + total;
                        addLog(`${nickname}님의 결과: [${total}]`);
                    }
                }, 400);
            });
        }
    </script>
</body>
</html>
